# Weraser 개발가이드

> **Single Source of Truth**: 제품 비전, 사용자 스토리, 성공지표는 [PRD.md](./PRD.md) 참조

## 📋 문서 목적
본 문서는 PRD.md의 제품 요구사항을 **실제로 구현하는 방법**을 다룹니다.
- **What & Why**: [PRD.md](./PRD.md) 참조
- **How & When**: 본 문서 참조

---

## 🏗️ 기술 아키텍처

### 핵심 기술 스택
- **Frontend**: HTML5/CSS3/JavaScript (Vanilla) → React 마이그레이션 고려
- **Backend**: Node.js + Express, Python FastAPI (AI 처리)
- **Database**: PostgreSQL (메타데이터), Pinecone (벡터), Redis (캐싱)
- **AI Models**: Gemini API (현재), Claude/GPT-4 (대안)
- **Infrastructure**: GitHub Pages (프로토타입), Vercel (프록시), AWS/GCP (프로덕션)

### 시스템 제약사항
- **CORS 제한**: 서버 프록시 구축 필수 (Vercel/Netlify Functions)
- **성능 목표**: 응답 시간 3초 이내, 동시 사용자 100명 이상
- **보안 요구**: End-to-end 암호화, RBAC, 감사 로그

---

## 📝 Phase 1: MVP 상세 명세

### 1.1 문서 관리 시스템

#### 1.1.1 소스 한도 정책 (구현됨)
```javascript
const QUOTA_LIMITS = {
    MAX_FILE_SIZE: 50,              // 개별 파일 최대 크기 (MB)
    PROJECT_QUOTA: 500,             // 프로젝트당 총 용량 (MB)
    USER_PERSONAL_QUOTA: 1024,      // 사용자별 개인 문서 할당량 (MB)
    MAX_FILES_PER_PROJECT: 1000,    // 프로젝트당 최대 문서 수
    MAX_SIMULTANEOUS_UPLOAD: 10,    // 최대 동시 업로드 파일 수
    DAILY_UPLOAD_LIMIT: 100         // 일일 업로드 한도 (MB)
};
```

#### 1.1.2 문서 업로드 워크플로우
- **통합 문서 추가 인터페이스**
  - 단일 "➕ 문서 추가" 버튼
  - 드롭다운: 조직 문서 불러오기 / 개인 문서 업로드
- **지원 형식**: PDF, Word, Excel, PPT, 이미지, 텍스트
- **업로드 검증**: 파일 형식, 크기, 용량 한도, 중복 검사
- **진행률 표시**: 개별/전체 진행률, 예상 완료 시간

#### 1.1.3 문서 분류 체계
**조직 문서**
- 공유 저장소에서 임포트
- 디렉토리 경로 유지 및 자동 동기화
- 메타정보: 디렉토리 경로, 업데이트 일시, 담당자명

**개인 문서**  
- 로컬에서 직접 업로드
- 사용자 정의 디렉토리 구조
- 메타정보: 업로드 일시, 디렉토리 경로, 유형

### 1.2 AI 채팅 시스템

#### 1.2.1 기본 채팅 기능 (구현됨)
- 자연어 질의응답 인터페이스
- Gemini API 통합 (CORS 해결을 위한 Smart Fallback)
- 멀티턴 대화 지원
- 컨텍스트 기반 대화 유지

#### 1.2.2 채팅 편의 기능 (구현됨)
- **로딩 시스템**: 응답 생성 중 스피너, 중지 버튼
- **메시지 편집**: Claude 스타일 contentEditable, 편집 시 AI 응답 재생성
- **응답 제어**: 중지/재개, 재생성 옵션
- **스트리밍**: 실시간 응답 스트리밍 (예정)

#### 1.2.3 RAG 통합
- 사내 문서 기반 '닫힌 책' RAG
- 모든 응답에 출처 문서 명시
- 환각 현상 원천 차단
- 참조 문서 하이라이트 및 원본 링크

### 1.3 프로젝트 관리

#### 1.3.1 프로젝트 구조 (구현됨)
- **프로젝트-문서**: 1:1 관계 (독립적 문서 저장소)
- **프로젝트-채팅**: 1:N 관계 (여러 채팅 세션)
- **계층적 네비게이션**: 프로젝트 목록 → 채팅 세션 목록

#### 1.3.2 용량 관리 (구현됨)
- 실시간 프로그레스 바 표시
- 용량 경고 알림 (80%, 95%, 100%)
- 중복 문서 감지 및 최적화 도구
- 파일별 용량 상세 보기

### 1.4 아티팩트 뷰 시스템

#### 1.4.1 플로팅 문서 뷰어 (진행 중)
- 채팅 우측 플로팅 패널
- 실제 문서 파일 내용 표시
- 메타정보: 경로, 일시, 담당자, 유형
- 키워드 하이라이트 및 섹션별 네비게이션

#### 1.4.2 문서 상호작용 (예정)
- 특정 섹션 선택 → 질문 자동 생성
- 문서 내 검색 기능
- 북마크 및 즐겨찾기

---

## 📅 Phase 1 개발 일정 (3개월)

### 1-2주차: 기반 구축 ✅
- [x] 프로젝트 환경 설정
- [x] 기본 UI 레이아웃 구현
- [x] 문서 관리 LNB 사이드바
- [x] 기본 채팅 인터페이스

### 3-4주차: 문서 관리 ✅
- [x] 문서 업로드 (드래그앤드롭)
- [x] 조직/개인 문서 분류
- [x] 용량 관리 프로그레스 바
- [x] 문서 메타정보 관리

### 5-6주차: AI 채팅 고도화 ✅
- [x] Gemini API 통합 (Mock 모드)
- [x] CORS 문제 해결방안
- [x] 채팅 편의 기능 (로딩/중지/편집)
- [x] 문서 기반 RAG 응답

### 7-8주차: 모달 UI/UX 개선 ✅
- [x] 모달 중복 방지 시스템
- [x] 소스 한도 내비게이션 추가
- [x] 단일 모달 워크플로우 구현
- [x] 조직/개인 문서 업로드 모달 개선

### 9-10주차: 아티팩트 뷰 ✅
- [x] 플로팅 문서 뷰어 기본 구조
- [ ] 실제 문서 내용 렌더링
- [ ] 키워드 하이라이트
- [ ] 문서 상호작용 기능

### 11-12주차: 테스트 및 배포
- [ ] 통합 테스트
- [ ] 성능 최적화  
- [x] GitHub Actions 자동 배포
- [ ] 사용자 피드백 수집

---

## 🛠️ 현재 구현 상태

### ✅ 완료된 기능
- 프로젝트 기반 문서 관리 시스템
- AI 채팅 인터페이스 (Gemini API)
- 소스 한도 관리 시스템 (용량 제한, 경고)
- 채팅 편의 기능 (로딩, 중지, 메시지 편집)
- 문서 업로드 UI/UX 개선
- 모달 UI/UX 개선 (중복 방지, 소스 한도 내비게이션)
- 조직/개인 문서 업로드 워크플로우
- GitHub Pages 자동 배포

### 🔄 진행 중
- 벡터 인덱싱 및 RAG 파이프라인
- 실제 문서 내용 렌더링 (아티팩트 뷰)
- 조직 문서 동기화 시스템

### 📋 다음 Action Items

#### 즉시 실행 (이번 주)
1. [x] 소스 한도 관리 시스템 완료
2. [x] 문서 업로드 UI/UX 개선 완료
3. [x] 문서 관리 구조 MECE 원칙 적용
4. [x] 모달 UI/UX 개선 (중복 방지, 소스 한도 내비게이션)
5. [ ] 벡터 임베딩 시스템 구축
6. [ ] 실제 문서 아티팩트 뷰 구현

#### 단기 실행 (2주 내)
1. [ ] 문서 자동 동기화 구현
2. [ ] RAG 파이프라인 구축  
3. [ ] 성능 최적화 (응답 시간 3초 이내)
4. [ ] Vercel 프록시 서버 구축

#### 중기 실행 (1개월 내)
1. [ ] 벡터 DB 통합 (Pinecone)
2. [ ] 전문 AI 에이전트 (물류/관세) 프로토타입
3. [ ] 베타 테스트 시작
4. [ ] 성능 모니터링 시스템

---

## 💰 예산 및 팀 구성

**상세 비즈니스 모델**: [PRD.md](./PRD.md) § 7. Business Requirements 참조

### 예산 개요
- **Phase 1**: $65,000 (MVP 개발 - 인건비 $60K, 인프라 $3K, AI API $2K)
- **Phase 2**: $96,000 (AI 에이전트 확장)
- **Phase 3**: $260,000 (엔터프라이즈 기능)

### 팀 구성
**현재 (Phase 1)**
- PM/기획: 1명
- Frontend 개발: 1명  
- Backend 개발: 1명
- AI 엔지니어: 1명
- UI/UX 디자이너: 1명

**확장 계획 (Phase 2-3)**
- DevOps: 1명 추가
- QA: 2명 추가
- 데이터 엔지니어: 1명 추가
- 비즈니스 개발: 2명 추가

---

## 🚀 Phase 2-3 로드맵 미리보기

### Phase 2: AI Agent (3-6개월)
- 전문 AI 에이전트 구현 (물류/관세/법무/회계)
- 멀티 에이전트 협업 시스템
- 워크플로우 자동화 템플릿
- 분석 대시보드

### Phase 3: Enterprise (6-12개월)  
- 아티팩트 시스템 고도화
- 전사 공유 및 권한 관리
- 외부 시스템 연동 (Slack/Teams/Jira)
- 보안 강화 (RBAC, 감사 로그)

---

## 🔧 기술 참고사항

### CORS 해결 방안
- **현재**: Smart Fallback (Mock 모드)
- **프로덕션**: Vercel 프록시 서버 구축
- **개발**: Chrome CORS 비활성화 모드

### 배포 구조
- **프로토타입**: GitHub Pages (자동 배포)
- **API 서버**: Vercel Functions  
- **프로덕션**: AWS/GCP

### 모니터링
- 실시간 성능 모니터링
- 에러 추적 및 분석
- 사용 패턴 분석

---

*최종 업데이트: 2025년 9월 1일*  
*버전: 1.0 (Single Source of Truth 적용)*